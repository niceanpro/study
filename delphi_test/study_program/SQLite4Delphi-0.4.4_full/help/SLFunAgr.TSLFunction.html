<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<META name="GENERATOR" content="PasDoc 0.8.7">
<TITLE>SLFunAgr: Class TSLFunction</TITLE>
<LINK rel="StyleSheet" href="SQLite4Delphi.css">
</HEAD>
<BODY bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor="e0e0e0">
<TD><A href="AllUnits.html"><CENTER>Units</CENTER></A></TD>
<TD><A href="ClassHierarchy.html"><CENTER>Class Hierarchy</CENTER></A></TD>
<TD><A href="AllClasses.html"><CENTER>Classes, Interfaces and Objects</CENTER></A></TD>
<TD><A href="AllTypes.html"><CENTER>Types</CENTER></A></TD>
<TD><A href="AllVariables.html"><CENTER>Variables</CENTER></A></TD>
<TD><A href="AllConstants.html"><CENTER>Constants</CENTER></A></TD>
<TD><A href="AllFunctions.html"><CENTER>Functions and Procedures</CENTER></A></TD>
<TD><A href="AllIdentifiers.html"><CENTER>Identifiers</CENTER></A></TD>
<TD><A href="GVUses.html"><CENTER></CENTER></A></TD>
<TD><A href="GVClasses.html"><CENTER></CENTER></A></TD>
</TR>
</TABLE>
<A name="TSLFunction"></A><H1>Class TSLFunction</H1>
<H2>Unit</H2>
<A href="SLFunAgr.html">SLFunAgr</A><BR><H2>Declaration</H2>
<P><CODE>type TSLFunction = class(<CODE><A href="SLFunAgr.TSLCustomFun.html">TSLCustomFun</A></CODE>)</CODE></P><H2>Description</H2>
Function class component<P>Duering query execution SQLite calls callback to determine result of function    or aggregation. From the manager callback can get pointer to function's object    and call <CODE><A href="SLFunAgr.TSLFunction.html#DoFunction">DoFunction</A></CODE> protected method. Here number of params    is checked - in case of problems an error is reported. The Method converts    array of PChar to TStringList so the engine is separated from your code but    one convertion more is done. At the end event <CODE><A href="SLFunAgr.TSLFunction.html#OnFunction">OnFunction</A></CODE>    is called.    <p> Parameters are passed as TStrings. Do not change list object - it is    common for all calls. You can change values, but I have no idea why.<H2>Hierarchy</H2>
<CODE><A href="SLFunAgr.TSLCustomFun.html">TSLCustomFun</A></CODE><A name=@Fields></A><H2>Fields</H2>
<TABLE cellspacing=2 cellpadding=4 width=100%><TR bgcolor="#e0e0e0"><TH>&nbsp;</TH><TH>Name</TH><TH>Description</TH></TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD><A name="FParamCount"></A><CODE>FParamCount</CODE></TD>
<TD width=100%>&nbsp;</TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD><A name="FParams"></A><CODE>FParams</CODE></TD>
<TD>&nbsp;</TD>
</TR>
</TABLE><H2>Methods</H2>
<H3>Overview</H3>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD width=100%><CODE>constructor <A href="SLFunAgr.TSLFunction.html#Create"><B>Create</B></A> (AOwner: TComponent); override;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD><CODE>destructor <A href="SLFunAgr.TSLFunction.html#Destroy"><B>Destroy</B></A>; override;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD><CODE>procedure <A href="SLFunAgr.TSLFunction.html#DoFunction"><B>DoFunction</B></A> (const aParamCount: Integer; const aParams: <A href="SLTypes.html#PPCharArray">PPCharArray</A>); virtual;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD><CODE>function <A href="SLFunAgr.TSLFunction.html#GetCallBackPtr"><B>GetCallBackPtr</B></A>: Pointer; virtual;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD><CODE>function <A href="SLFunAgr.TSLFunction.html#GetResTypeAsInt"><B>GetResTypeAsInt</B></A>: Integer;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD><CODE>procedure <A href="SLFunAgr.TSLFunction.html#SetActive"><B>SetActive</B></A> (const aValue: Boolean); override;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD><CODE>procedure <A href="SLFunAgr.TSLFunction.html#SetParamCount"><B>SetParamCount</B></A> (const aValue: Integer);</CODE></TD>
</TR>
</TABLE>
<H3>Description</H3>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD width=100%><A name="Create"></A><CODE>constructor <B>Create</B> (AOwner: TComponent); override;</CODE></TD>
</TR>
</TABLE>
<P>&nbsp;</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD width=100%><A name="Destroy"></A><CODE>destructor <B>Destroy</B>; override;</CODE></TD>
</TR>
</TABLE>
<P>&nbsp;</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD width=100%><A name="DoFunction"></A><CODE>procedure <B>DoFunction</B> (const aParamCount: Integer; const aParams: <A href="SLTypes.html#PPCharArray">PPCharArray</A>); virtual;</CODE></TD>
</TR>
</TABLE>
<P>&nbsp;</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD width=100%><A name="GetCallBackPtr"></A><CODE>function <B>GetCallBackPtr</B>: Pointer; virtual;</CODE></TD>
</TR>
</TABLE>
<P>&nbsp;</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="public.gif" alt="Public"></TD>
<TD width=100%><A name="GetResTypeAsInt"></A><CODE>function <B>GetResTypeAsInt</B>: Integer;</CODE></TD>
</TR>
</TABLE>
<P>&nbsp;</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD width=100%><A name="SetActive"></A><CODE>procedure <B>SetActive</B> (const aValue: Boolean); override;</CODE></TD>
</TR>
</TABLE>
<P>Main process of encounting function result<P>First number of params is checked - in case of problems an error is      reported. The Method converts array of PChar to TStringList so the      engine is separated from your code but one convertion more is done.      At the end event <CODE><A href="SLFunAgr.TSLFunction.html#OnFunction">OnFunction</A></CODE> is called.</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="protected.gif" alt="Protected"></TD>
<TD width=100%><A name="SetParamCount"></A><CODE>procedure <B>SetParamCount</B> (const aValue: Integer);</CODE></TD>
</TR>
</TABLE>
<P>Writter of property ParamCount. It allocates space for      param list.</P>
<H2>Properties</H2>
<H3>Overview</H3>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="published.gif" alt="Published"></TD>
<TD width=100%><CODE>property <A href="SLFunAgr.TSLFunction.html#OnFunction"><B>OnFunction</B></A>: <A href="SLFunAgr.html#TOnFunction">TOnFunction</A>;</CODE></TD>
</TR>
<TR bgcolor=#efefef valign=top><TD><IMG src="published.gif" alt="Published"></TD>
<TD><CODE>property <A href="SLFunAgr.TSLFunction.html#ParamCount"><B>ParamCount</B></A>: Integer;</CODE></TD>
</TR>
</TABLE>
<H3>Description</H3>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="published.gif" alt="Published"></TD>
<TD width=100%><A name="OnFunction"></A><CODE>property <B>OnFunction</B>: <A href="SLFunAgr.html#TOnFunction">TOnFunction</A>;</CODE></TD>
</TR>
</TABLE>
<P>abstract(Event for function encounting)      You can be sure that number of params is propper. Results should be returned      with one of methods <CODE>TSLDatabase.SetResultString</CODE>,      <CODE>TSLDatabase.SetResultInt</CODE>, <CODE>TSLDatabase.SetResultDouble</CODE> - depends      on the result's type. In case of problems <CODE>TSLDatabase.SetResultError</CODE>      method should be called</P>
<TABLE cellspacing=2 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD><IMG src="published.gif" alt="Published"></TD>
<TD width=100%><A name="ParamCount"></A><CODE>property <B>ParamCount</B>: Integer;</CODE></TD>
</TR>
</TABLE>
<P>abstract(Number of parameters used by function)</P>
<HR noshade size=1><EM>Generated by <A href="http://pasdoc.sourceforge.net/">PasDoc 0.8.7</A> on N 16- lis 2003 16:05:18</EM>
</BODY>
</HTML>
